<!DOCTYPE html>
<html>
<head>
    <title>Simple Computer Emulator</title>
    <style>
        body { background: #000; color: #0f0; font-family: monospace; padding: 20px; }
        #memory, #registers, #output { 
            background: #001100; 
            padding: 10px; 
            margin: 10px 0; 
            border: 1px solid #0f0; 
        }
        #code { 
            width: 100%; 
            height: 100px; 
            background: #001100; 
            color: #0f0; 
            border: 1px solid #0f0; 
        }
    </style>
</head>
<body>
    <h2>Simple Computer Emulator</h2>
    <div id="power-panel">
        <button onclick="powerSystem.powerOn()">Power On</button>
        <button onclick="powerSystem.powerOff()">Power Off</button>
    </div>
    <div id="display" style="background: #001100; padding: 10px; margin: 10px 0; border: 1px solid #0f0;"></div>
    <textarea id="code">MOV A,5
ADD A,3
OUT A</textarea>
    <button onclick="emulator.run()">Run</button>
    <div id="registers">Registers:</div>
    <div id="memory">Memory:</div>
    <div id="output">Output:</div>

    <script src="power.js"></script> 
    <script>
        // Instantiate the PowerSystem after its class definition is loaded.
        // This makes 'powerSystem' available globally for the buttons to use.
        const powerSystem = new PowerSystem(); 

        // This is an example of how you can 'listen' to the power system's state changes.
        // Open your browser's developer console (F12) to see these messages.
        powerSystem.onStateChange((newState) => {
            console.log("Power system state changed to:", newState);

            if (newState === 'BIOS') {
                console.log("System is ready for user input or program loading!");
                // You could enable the 'Run' button here, for example:
                // document.querySelector('button[onclick="emulator.run()"]').disabled = false;
            } else if (newState === 'OFF') {
                console.log("System is completely shut down.");
                // You could disable the 'Run' button here:
                // document.querySelector('button[onclick="emulator.run()"]').disabled = true;
            }
        });

        console.log("Initial power system state:", powerSystem.state);
    </script>
    <script src="emulator.js"></script> 
</body>
</html>
