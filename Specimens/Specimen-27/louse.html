<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <base href="machine-touched.github.io/Machine_Touched" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="noindex,follow" />
  <meta name="description" content="A playful overlay: the Digital Clothing Louse. Sapien tech familiar. Rasta LEDs. Touch blood pulse." />
  <title>Digital Clothing Louse â€” Familiar</title>
  <style>
    :root{
      --neon:#00ff41; --alt:#00d4ff; --blood:#ff2d55; --veil: rgba(0,0,0,.85);
    }
    *{ box-sizing: border-box; }
    html, body { height:100%; }
    body{
      margin:0; background: transparent; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      position: fixed; inset:0; width:100vw; height:100vh; overflow: hidden; pointer-events: none; /* let clicks reach parent */
    }

    .louse{
      position: absolute; left: 50vw; top: 40vh; transform: translate(-50%,-50%);
      font-size: 18px; color: var(--neon); text-shadow: 0 0 8px var(--neon);
      filter: drop-shadow(0 0 6px var(--neon));
      animation: roam 22s linear infinite;
      will-change: transform; user-select: none;
    }
    .louse[data-mode="investigate"]{ animation: investigate 8s ease-in-out infinite; }
    .louse[data-mode="wander"]{ animation: wander 28s linear infinite; }

    @keyframes roam{
      0%{ transform: translate(5vw,10vh) rotate(0deg);} 25%{ transform: translate(65vw,20vh) rotate(90deg);} 50%{ transform: translate(75vw,70vh) rotate(180deg);} 75%{ transform: translate(20vw,60vh) rotate(270deg);} 100%{ transform: translate(5vw,10vh) rotate(360deg); }
    }
    @keyframes investigate{ 0%,100%{ transform: translate(-50%,-50%) scale(1);} 50%{ transform: translate(-50%,-50%) scale(1.25) rotate(12deg);} }
    @keyframes wander{
      0%{ transform: translate(8vw, 15vh);} 20%{ transform: translate(35vw, 25vh);} 40%{ transform: translate(70vw, 35vh);} 60%{ transform: translate(62vw, 75vh);} 80%{ transform: translate(18vw, 65vh);} 100%{ transform: translate(8vw, 15vh);} }

    .beam{ position:absolute; left:50%; top:50%; width:34px; height:2px; background: linear-gradient(90deg, transparent, var(--neon), transparent); transform: translate(-50%,-50%); opacity:0; pointer-events:none; }
    .beam.on{ opacity:.75; animation: spin 2.6s linear infinite; }
    @keyframes spin{ from{ transform: translate(-50%,-50%) rotate(0);} to{ transform: translate(-50%,-50%) rotate(360deg);} }

    .thought{ position:absolute; bottom: 26px; left:50%; transform: translateX(-50%); background: var(--veil); color: var(--neon);
      padding:6px 10px; border:1px solid var(--neon); border-radius:10px; font-size: 11px; white-space: nowrap; opacity:0; transition: .25s ease; box-shadow: 0 0 10px rgba(0,255,65,.25); }
    .thought.show{ opacity:1; }
    .thought::after{ content:""; position:absolute; top:100%; left:50%; transform: translateX(-50%); border:6px solid transparent; border-top-color: var(--neon); }

    .bits { position:absolute; inset:0; pointer-events:none; }
    .bit { position:absolute; width:2px; height:2px; background: var(--neon); border-radius:2px; opacity: .9; animation: drift 1.6s ease-out forwards; }
    @keyframes drift{ from{ transform: translate(0,0); opacity:1;} to{ transform: translate(0,-24px) scale(.2); opacity:0;} }

    /* rasta pilot lights */
    .pilot { position: fixed; right: 16px; bottom: 16px; display:flex; gap:8px; pointer-events:none; }
    .pilot i { width:10px; height:10px; border-radius:12px; filter: drop-shadow(0 0 6px rgba(255,255,255,.35)); opacity:.9 }
    .pilot .r{ background:#e53935; animation: pulse 2.6s ease-in-out infinite; }
    .pilot .y{ background:#fdd835; animation: pulse 2.6s ease-in-out infinite .35s; }
    .pilot .g{ background:#43a047; animation: pulse 2.6s ease-in-out infinite .7s; }
    @keyframes pulse{ 0%,100%{ transform: scale(.8);} 50%{ transform: scale(1);} }

    /* reduce motion respect */
    @media (prefers-reduced-motion: reduce){ *{ animation: none !important; transition: none !important; } }
  </style>
</head>
<body>
  <!-- familiar sprite + ui -->
  <div class="louse" id="louse" aria-label="digital clothing louse" role="img">ðŸ¦ </div>
  <div class="beam" id="beam" aria-hidden="true"></div>
  <div class="thought" id="thought" aria-live="polite"></div>
  <div class="bits" id="bits" aria-hidden="true"></div>
  <div class="pilot" aria-hidden="true"><i class="r"></i><i class="y"></i><i class="g"></i></div>

  <script>
    // Sapien Tech Familiar â€” Malazan camp-talk commentary
    const chants = {
      searching:[
        'scanning for cloth-signalâ€¦',
        'sifting lint for lettersâ€¦',
        'cache crumbs on the windâ€¦',
        'jar whispers: move quietâ€¦',
      ],
      investigating:[
        'anomaly tastes like copperâ€¦',
        'pattern snagged, thread pulledâ€¦',
        'does it bleed ones or zeroes? both.',
      ],
      satisfied:[
        'sample bottled. bless the jar.',
        'touch blood. oath holds.',
        'logged and marched.',
      ]
    };

    const sprite = document.getElementById('louse');
    const beam = document.getElementById('beam');
    const bubble = document.getElementById('thought');
    const bits = document.getElementById('bits');

    function say(t){ bubble.textContent = t; bubble.classList.add('show'); setTimeout(()=> bubble.classList.remove('show'), 2800); }
    function randomOf(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    // idle musings
    setInterval(()=>{ say(randomOf(chants.searching)); }, 5600);

    // synthetic mouse-follow: since this overlay ignores pointer events to not steal clicks
    window.addEventListener('message', e=>{
      if(!e || !e.data) return; const {type, x, y} = e.data;
      if(type === 'poke'){ investigateAt(x,y); }
    });

    // provide a gentle self-driven investigate burst every ~15s
    setInterval(()=>{
      const x = Math.random()*innerWidth, y = Math.random()*innerHeight;
      investigateAt(x,y);
    }, 15000);

    function investigateAt(x,y){
      sprite.dataset.mode = 'investigate';
      beam.classList.add('on');
      sprite.style.left = x + 'px';
      sprite.style.top = y + 'px';
      say(randomOf(chants.investigating));
      sprinkle(x,y,6);
      setTimeout(()=>{ sprite.dataset.mode=''; beam.classList.remove('on'); say(randomOf(chants.satisfied)); }, 2200);
    }

    function sprinkle(x,y,n){
      for(let i=0;i<n;i++){
        const p = document.createElement('i');
        p.className='bit';
        p.style.left = (x + (Math.random()*24-12)) + 'px';
        p.style.top = (y + (Math.random()*24-12)) + 'px';
        bits.appendChild(p);
        setTimeout(()=> p.remove(), 1600);
      }
    }

    // Optional: if parent window wants to poke the louse on click
    try {
      window.top.addEventListener('click', (evt)=>{
        const rect = { x: evt.clientX, y: evt.clientY };
        window.postMessage({ type:'poke', x: rect.x, y: rect.y }, '*');
      }, { passive: true });
    } catch(_) { /* cross-origin parent; ignore */ }
  </script>
</body>
</html>
